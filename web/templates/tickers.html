{% extends "base.html" %}
{% block content %}
<div class="container">
  <!-- Первый ряд с кнопками -->
  <div class="row" style="align-items: center;">
    <div class="w-50"><a href="/" class="button">← Назад</a></div>
    <div class="w-50" style="text-align: right;">
      <button class="button" onclick="openTickerPopup()">Добавить тикер</button>
    </div>
  </div>

  <!-- Второй ряд с таблицей -->
  <div class="row">
    <div class="widget w-100">
      <h2><i class="fas fa-table icon"></i> Информация по тикерам</h2>
      <table style="width: 100%; border-collapse: collapse; table-layout: fixed;">
        <thead>
          <tr>
            <th style="padding: 0.6rem; border: 1px solid #d0d7de;">Название</th>
            <th style="padding: 0.6rem; border: 1px solid #d0d7de;">Курс</th>
            <th style="background-color: #eef1f4; padding: 0.6rem; border: 1px solid #d0d7de;">Winrate 24h</th>
            <th style="background-color: #eef1f4; padding: 0.6rem; border: 1px solid #d0d7de;">ROI 24h</th>
            <th style="background-color: #dce1e6; padding: 0.6rem; border: 1px solid #d0d7de;">Winrate 7d</th>
            <th style="background-color: #dce1e6; padding: 0.6rem; border: 1px solid #d0d7de;">ROI 7d</th>
            <th style="padding: 0.6rem; border: 1px solid #d0d7de;">Статус</th>
            <th style="padding: 0.6rem; border: 1px solid #d0d7de;">Управление</th>
          </tr>
        </thead>
        <tbody>
          {% for t in tickers %}
          <tr>
            <td style="padding: 0.6rem; border: 1px solid #d0d7de;"><a href="/tickers/{{ t.symbol }}">{{ t.symbol }}</a></td>
            <td style="padding: 0.6rem; border: 1px solid #d0d7de;">{{ t.price if t.price else 'n/a' }} <span style="color: green;">▲</span></td>
            <td style="background-color: #eef1f4; padding: 0.6rem; border: 1px solid #d0d7de;">{{ t.winrate_24h if t.winrate_24h else 'n/a' }}</td>
            <td style="background-color: #eef1f4; padding: 0.6rem; border: 1px solid #d0d7de;">{{ t.roi_24h if t.roi_24h else 'n/a' }}</td>
            <td style="background-color: #dce1e6; padding: 0.6rem; border: 1px solid #d0d7de;">{{ t.winrate_7d if t.winrate_7d else 'n/a' }}</td>
            <td style="background-color: #dce1e6; padding: 0.6rem; border: 1px solid #d0d7de;">{{ t.roi_7d if t.roi_7d else 'n/a' }}</td>
            <td style="padding: 0.6rem; border: 1px solid #d0d7de;"><span style="color: orange;">●</span></td>
            <td style="padding: 0.6rem; border: 1px solid #d0d7de;">
              <button onclick="toggleStatus(this)">Включить</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
function toggleStatus(btn) {
  const isActive = btn.textContent.trim() === 'Выключить';
  btn.textContent = isActive ? 'Включить' : 'Выключить';
  btn.style.backgroundColor = isActive ? '#e0e0e0' : '#cce5ff';
}

function openTickerPopup() {
  window.open("/tickers/new", "new_ticker", "width=600,height=400,scrollbars=no,resizable=no,toolbar=no,menubar=no,status=no");
}
</script>
{% endblock %}
